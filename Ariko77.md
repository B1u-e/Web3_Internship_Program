---
timezone: UTC+8
---

# 刘星璇

**GitHub ID:** Ariko77

**Telegram:** @paekko

## Self-introduction

区块链工程专业在校学生，目前努力方向是区块链安全审计，还是小白

## Notes

<!-- Content_START -->
# 2025-08-04

今天忙着搬家 简单学了一点
以太坊交易使用的是 **ECDSA**（椭圆曲线数字签名算法）。一个签名由以下三部分组成：

+ `r`（32字节）
+ `s`（32字节）
+ `v`（1字节，用来标识哪个公钥对应这个签名）

# 签名冒充impersonation
在某些合约中，可能存在这样的验证逻辑：

```plain
address recovered = ecrecover(hash, v, r, s);
require(recovered == expectedSigner);
```

这段逻辑的意思是：**只要你能提供一个合法签名，它 recover 出来的地址是某个特定地址，那就放你过。**

# 签名可拓展性
ECDSA 签名是 **不唯一的！** 对于一个消息 `m` 和私钥 `sk`，你可以构造 **多个不同的签名**，它们都能成功通过验证。

主要原因在于：

对同一个 `(r, s)`，也可以构造 `(r, -s mod n)`，它也是合法的签名。

以太坊中，为了避免这种问题，现在规定：

+ `s` 必须在 `n / 2` 以下（`n` 是椭圆曲线的阶）
+ 否则签名就是非法的

但如果合约自己实现 `ecrecover` 验证，而**没有验证 **`**s**`** 是否小于 **`**n/2**`，那攻击者就可以“拓展”签名，**用另一个合法但不同的 **`**(r, s)**`** 对伪造签名**，从而伪装成原始签名者。


# 2025.07.30


<!-- Content_END -->
